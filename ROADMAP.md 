ğŸ—ºï¸ yapi Roadmap: The Standard for Git-Native API Development

Mission: To replace heavy, cloud-forced API clients with a fast, offline-first, git-friendly CLI tool. We treat API requests as codeâ€”versionable, diff-able, composable, and executable anywhere.

ğŸ“… Phase 1: The "Local-First" Wedge (DevEx & Workflow)

Goal: Make the single-player experience 10x better than Curl and faster than Postman. Focus on reducing boilerplate and enabling complex workflows.

ğŸ§© 1. Composability Engine (The "App Router" for APIs)

Problem: Duplicating https://api.example.com and Authorization: Bearer... across 50 files is painful.
Solution: Hierarchical configuration inheritance.
Ref: "Context & Inheritance" RFC

[ ] Context Loading: Update loader to traverse directory trees (upwards) looking for yapi.yaml configuration files.

[ ] Recursive Merge: Implement specific merge strategies:

Scalars (base_url): Leaf wins (or Child concatenates path to Parent base_url).

Maps (headers, vars): Key-wise merge (Leaf overrides specific keys).

Lists (middleware): Append/Chain.

[ ] Environment Profiles: Support switching contexts via CLI (e.g., yapi run --env staging) defined in root configs.

ğŸ”— 2. Request Chaining (The "DAG" Engine)

Problem: Real APIs require state (Login $\to$ Get Token $\to$ Create Resource).
Solution: A stateful execution engine.
Ref: TODO/CHAIN.md

[ ] Architecture Refactor: Implement the "Chain of 1" model (every request is a chain).

[ ] Dependency Graph: Build a DAG solver to determine execution order based on variable references.

[ ] Variable Syntax: Implement ${step.format.path} syntax (e.g., ${login.json.token}).

[ ] Pipefail Logic: Enforce implicit assertions (if Step B needs JSON from Step A, Step A must return valid JSON).

ğŸ› ï¸ 3. Advanced Editor Integration (LSP)

Problem: "Magic" inheritance makes it hard to know what the final request looks like.
Solution: "Virtual Merge" in the Language Server.

[ ] Virtual Context: LSP scans the workspace graph to calculate the "Effective Request" in memory without running it.

[ ] "Resolved Value" Hover: Hovering over a path shows the full resolved URL (inherited from parents).

[ ] Context-Aware Autocomplete: Autocomplete variables (${vars.user_id}) defined in parent yapi.yaml files.

[ ] VS Code Extension: Wrap yapi lsp into a native VS Code extension with CodeLens ("â–¶ Run" buttons).

ğŸ“… Phase 2: The "CI/CD" Wedge (Reliability)

Goal: Become part of the engineering infrastructure. If it lives in the repo, it should run in the pipeline.

âœ… 1. Validation Engine (expect blocks)

Move beyond "eyeballing" responses to automated contract testing.
Ref: TODO/VALIDATE.md

[ ] Status Assertions: Support explicit status: 2xx or status: [200, 201].

[ ] Header Matching: Glob matching for headers (e.g., Content-Type: application/*).

[ ] Body Assertions: Exact Match, Partial Match, and JQ Assertions.

[ ] JSON Schema: Support validating response bodies against inline or referenced JSON Schemas.

ğŸ¤– 2. CI/CD Command

[ ] yapi test: A dedicated mode that suppresses UI output and returns non-zero exit codes on failure.

[ ] Reporters: Output results in JUnit XML or TAP format for Jenkins/GitHub Actions.

[ ] Bail Mode: --bail flag to stop execution on the first failure in a chain.

ğŸ“… Phase 3: The "Viral" & Ecosystem Wedge

Goal: Growth loops and friction reduction.

ğŸ”„ 1. Migration Tools

[ ] yapi import curl: Paste a curl command, get a valid .yapi.yml.

[ ] yapi import postman: Convert Postman collections to a folder structure of yapi files (preserving folder hierarchy as yapi.yaml contexts).

ğŸ·ï¸ 2. "Run in yapi" Badge

[ ] Deep Linking: Create a mechanism for https://yapi.run/run?url=... to load a config into the web playground.

[ ] Badge Generator: Provide Markdown snippets for OSS maintainers.

ğŸ–¥ï¸ 3. Mock Server (yapi serve)

Invert the definitions to create instant mock servers.
Ref: TODO/_SERVE-wip-vibed.md

[ ] Request Matching: Match incoming HTTP requests against defined url/method in yapi files.

[ ] Response Generation: Return the data defined in expect or example blocks.

ğŸ¨ Quality of Life & Polish

[ ] Secrets: First-class support for .env file loading and prioritization.

[ ] TUI History: Interactive history search (yapi history) with fuzzy filtering.

[ ] WebSockets: Add ws:// support to the Executor.
